
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Calendario NPC Argentina 2026</title>
    <link rel="manifest" href="manifest.json">
    
    <!-- Librerías -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { background-color: #000; font-family: -apple-system, system-ui, sans-serif; overflow: hidden; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- CONFIGURACIÓN FIREBASE ---
        const firebaseConfig = {
            apiKey: "AIzaSyB30MYN6crHgI8LUf-WMSuuWgng_bqVi9A",
            authDomain: "npc-argentina-2026.firebaseapp.com",
            projectId: "npc-argentina-2026",
            storageBucket: "npc-argentina-2026.firebasestorage.app",
            messagingSenderId: "133481912186",
            appId: "1:133481912186:web:6aedcd68fb0df7906128c3"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const { useState, useEffect } = React;
        const LOGO_URL = "https://github.com/user-attachments/assets/e2a6343a-023e-45d3-a8e3-f5ebcc192d25"; 

        // --- DATOS INICIALES ---
        const INITIAL_DATA = [
            { id: 1, dateDay: "12", dateMonth: "ABR", name: "Open Capital", location: "CABA", league: "REGIONAL", highlight: false, order: 1 },
            { id: 2, dateDay: "10", dateMonth: "MAY", name: "Rock Hard Physique", location: "CABA", league: "REGIONAL", highlight: false, order: 2 },
            { id: 3, dateDay: "14", dateMonth: "JUN", name: "ROCKY", location: "CABA", league: "REGIONAL", highlight: false, order: 3 },
            { id: 4, dateDay: "09", dateMonth: "AGO", name: "Salta Muscleshow", location: "Salta", league: "REGIONAL", highlight: false, order: 4 },
            { id: 5, dateDay: "14-16", dateMonth: "AGO", name: "ARGENTINO NATURALS + NPC", subtext: "Sur Pro Cup (Wellness + Classic PRO)", location: "ARGENTINA", league: "PRO QUALIFIER / PRO", highlight: true, order: 5 },
            { id: 6, dateDay: "30", dateMonth: "AGO", name: "La Plata Muscleshow", location: "La Plata", league: "REGIONAL", highlight: false, order: 6 },
            { id: 7, dateDay: "06", dateMonth: "SEP", name: "Córdoba Muscleshow", location: "Córdoba", league: "REGIONAL", highlight: false, order: 7 },
            { id: 8, dateDay: "13", dateMonth: "SEP", name: "EXCALIBUR", location: "CABA", league: "REGIONAL", highlight: false, order: 8 },
            { id: 9, dateDay: "04", dateMonth: "OCT", name: "Medal of Honor", location: "CABA", league: "REGIONAL", highlight: false, order: 9 },
            { id: 10, dateDay: "25", dateMonth: "OCT", name: "Fortress Weekend", location: "Santa Fe", league: "REGIONAL", highlight: false, order: 10 },
            { id: 11, dateDay: "01", dateMonth: "NOV", name: "IRONMAN CUP", location: "CABA", league: "REGIONAL", highlight: false, order: 11 },
            { id: 12, dateDay: "14-15", dateMonth: "NOV", name: "Mar del Plata Muscleshow", location: "Mar del Plata", league: "REGIONAL", highlight: false, order: 12 },
            { id: 13, dateDay: "29", dateMonth: "NOV", name: "NPC Mr. Salta", location: "Salta", league: "REGIONAL", highlight: false, order: 13 },
            { id: 14, dateDay: "06", dateMonth: "DIC", name: "B.A Cup", location: "CABA", league: "REGIONAL", highlight: false, order: 14 },
            { id: 15, dateDay: "12-13", dateMonth: "DIC", name: "NATURALS NATIONALS + WORLD", subtext: "Sur Pro Cup (Bikini + 212 PRO)", location: "CABA", league: "PRO QUALIFIER / PRO", highlight: true, order: 15 },
        ];

        // --- ICONOS ---
        const Icon = ({ path, size = 20, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{path}</svg>
        );
        const Icons = {
            MapPin: (p) => <Icon path={<><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></>} {...p} />,
            Search: (p) => <Icon path={<><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></>} {...p} />,
            Heart: (p) => <Icon path={<path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5 4.5 2-1.5 3.5-2.71 2-5.5A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>} {...p} />,
            Calendar: (p) => <Icon path={<><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></>} {...p} />,
            User: (p) => <Icon path={<><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></>} {...p} />,
            Home: (p) => <Icon path={<><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></>} {...p} />,
            Bell: (p) => <Icon path={<><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></>} {...p} />,
            Settings: (p) => <Icon path={<><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></>} {...p} />,
            Upload: (p) => <Icon path={<><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></>} {...p} />
        };

        const App = () => {
            const [events, setEvents] = useState([]);
            const [loading, setLoading] = useState(true);
            const [activeTab, setActiveTab] = useState('home');
            const [savedIds, setSavedIds] = useState([]);
            const [uploading, setUploading] = useState(false);
            const [showAdminModal, setShowAdminModal] = useState(false);
            const [dbStatus, setDbStatus] = useState("ok"); // 'ok', 'empty', 'error'

            useEffect(() => {
                const loadData = async () => {
                    try {
                        const q = query(collection(db, "events"), orderBy("order", "asc"));
                        const querySnapshot = await getDocs(q);
                        
                        if (querySnapshot.empty) {
                            setDbStatus("empty");
                            setEvents([]);
                        } else {
                            const loadedEvents = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                            setEvents(loadedEvents);
                            setDbStatus("ok");
                        }
                    } catch (error) {
                        console.error("Error cargando DB:", error);
                        setDbStatus("error");
                        setEvents(INITIAL_DATA);
                    } finally {
                        setLoading(false);
                    }
                };
                
                loadData();
                const saved = localStorage.getItem('npc_arg_favorites');
                if (saved) setSavedIds(JSON.parse(saved));
            }, []);

            const uploadData = async () => {
                setUploading(true);
                try {
                    for (const event of INITIAL_DATA) {
                        const { id, ...data } = event; 
                        await addDoc(collection(db, "events"), { ...data, order: event.id }); 
                    }
                    alert("✅ ¡Base de datos inicializada correctamente! Recargando...");
                    window.location.reload();
                } catch (e) {
                    alert("❌ Error: " + e.message + "\n\nRevisa que las 'Reglas' en Firebase permitan lectura/escritura (true).");
                } finally {
                    setUploading(false);
                }
            };

            const toggleSave = (id) => {
                const newSaved = savedIds.includes(id) ? savedIds.filter(sid => sid !== id) : [...savedIds, id];
                setSavedIds(newSaved);
                localStorage.setItem('npc_arg_favorites', JSON.stringify(newSaved));
            };

            const filteredEvents = events.filter(t => activeTab === 'saved' ? savedIds.includes(t.id) || savedIds.includes(String(t.id)) : true);

            return (
                <div className="flex justify-center min-h-screen bg-black">
                    <div className="w-full max-w-md h-[100dvh] bg-neutral-950 relative flex flex-col shadow-2xl border-x border-neutral-900">
                        
                        {/* HEADER */}
                        <div className="px-5 pt-6 pb-4 bg-neutral-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-30">
                            <div className="flex justify-between items-center mb-4">
                                <div className="flex items-center gap-3">
                                    <img src={LOGO_URL} alt="Logo NPC" className="w-10 h-10 rounded-full object-cover shadow-lg shadow-blue-900/50 bg-neutral-800" />
                                    <div>
                                        <h1 className="text-white font-bold text-lg leading-none">NPC Argentina</h1>
                                        <span className="text-xs text-blue-400 font-medium tracking-wide">Temporada 2026</span>
                                    </div>
                                </div>
                                <button 
                                    onClick={() => setShowAdminModal(true)} 
                                    className="p-2 bg-neutral-800 rounded-full text-neutral-400 hover:text-white transition-colors"
                                >
                                    <Icons.Settings size={20} />
                                </button>
                            </div>
                            
                            {/* MENSAJE DE ESTADO OFFLINE */}
                            {dbStatus === "error" && (
                                <div className="bg-red-900/30 border border-red-800 rounded p-2 text-center mb-2">
                                    <p className="text-xs text-red-200">⚠️ Modo Offline (Revisa Firebase)</p>
                                </div>
                            )}
                        </div>

                        {/* ADMIN MODAL */}
                        {showAdminModal && (
                            <div className="fixed inset-0 z-50 bg-black/90 backdrop-blur-sm flex items-center justify-center p-6 fade-in">
                                <div className="bg-neutral-900 border border-neutral-800 rounded-2xl p-6 w-full max-w-sm relative">
                                    <button onClick={() => setShowAdminModal(false)} className="absolute top-4 right-4 text-gray-500 hover:text-white">✕</button>
                                    <h2 className="text-xl font-bold text-white mb-4">Panel de Control</h2>
                                    <p className="text-gray-400 text-sm mb-6">Herramientas de administración para la base de datos.</p>
                                    
                                    <button 
                                        onClick={uploadData} 
                                        disabled={uploading}
                                        className="w-full bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-3 rounded-xl mb-3 flex items-center justify-center gap-2"
                                    >
                                        <Icons.Upload size={20} />
                                        {uploading ? "Subiendo..." : "Inicializar / Resetear DB"}
                                    </button>

                                    <button 
                                        onClick={() => window.location.reload()}
                                        className="w-full bg-neutral-800 text-white font-medium py-3 rounded-xl"
                                    >
                                        Recargar App
                                    </button>
                                </div>
                            </div>
                        )}

                        {/* CONTENIDO */}
                        <div className="flex-1 overflow-y-auto px-4 py-4 space-y-3 pb-24 scrollbar-hide">
                            {loading && <div className="text-center text-gray-500 py-10 animate-pulse">Cargando...</div>}

                            {!loading && filteredEvents.length === 0 && (
                                <div className="text-center text-gray-500 py-10">No hay eventos.</div>
                            )}

                            {filteredEvents.map((item) => (
                                <div key={item.id} className="bg-neutral-900/50 rounded-2xl p-3 border border-neutral-800 relative fade-in">
                                    <div className="flex gap-4">
                                        <div className={`w-16 h-16 rounded-xl flex flex-col items-center justify-center shrink-0 shadow-lg ${item.highlight ? 'bg-gradient-to-br from-yellow-500 to-yellow-600 text-black' : 'bg-neutral-800 text-neutral-400'}`}>
                                            <span className="text-xl font-bold leading-none">{item.dateDay.split('-')[0]}</span>
                                            <span className="text-[10px] font-black uppercase mt-1">{item.dateMonth}</span>
                                        </div>
                                        <div className="flex-1 min-w-0 flex flex-col justify-center">
                                            <div className="flex justify-between items-start">
                                                <span className={`text-[9px] font-bold px-1.5 py-0.5 rounded uppercase mb-1.5 inline-block tracking-wider ${item.highlight ? 'bg-red-900/30 text-red-400 border border-red-900/50' : 'bg-neutral-800 text-neutral-500'}`}>
                                                    {item.league}
                                                </span>
                                                <button onClick={(e) => { e.stopPropagation(); toggleSave(item.id); }} className="p-1 -mt-1 -mr-1 text-neutral-600 hover:text-red-500 transition-colors active:scale-125">
                                                    <Icons.Heart size={20} className={savedIds.includes(item.id) || savedIds.includes(String(item.id)) ? "fill-red-500 text-red-500" : ""} />
                                                </button>
                                            </div>
                                            <h3 className={`font-bold text-sm leading-tight mb-1 truncate ${item.highlight ? 'text-yellow-400' : 'text-white'}`}>
                                                {item.name}
                                            </h3>
                                            <div className="flex items-center gap-1 text-neutral-500 text-xs mt-auto">
                                                <Icons.MapPin size={12} /> <span className="truncate">{item.location}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>

                        {/* NAVBAR */}
                        <div className="h-[80px] bg-neutral-950/90 backdrop-blur-lg border-t border-neutral-900 absolute bottom-0 w-full flex justify-around items-start pt-4 z-40">
                            <button onClick={() => setActiveTab('home')} className={`flex flex-col items-center gap-1 w-20 ${activeTab === 'home' ? 'text-blue-500' : 'text-neutral-600'}`}>
                                <Icons.Home size={24} strokeWidth={activeTab === 'home' ? 3 : 2} /><span className="text-[10px]">Inicio</span>
                            </button>
                            <button onClick={() => setActiveTab('saved')} className={`flex flex-col items-center gap-1 w-20 ${activeTab === 'saved' ? 'text-blue-500' : 'text-neutral-600'}`}>
                                <Icons.Calendar size={24} strokeWidth={activeTab === 'saved' ? 3 : 2} /><span className="text-[10px]">Agenda</span>
                            </button>
                            <button onClick={() => setActiveTab('profile')} className={`flex flex-col items-center gap-1 w-20 ${activeTab === 'profile' ? 'text-blue-500' : 'text-neutral-600'}`}>
                                <Icons.User size={24} strokeWidth={activeTab === 'profile' ? 3 : 2} /><span className="text-[10px]">Perfil</span>
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>




